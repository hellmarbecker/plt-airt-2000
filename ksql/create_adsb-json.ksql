DROP STREAM IF EXISTS `adsb-json`;

CREATE STREAM `adsb-json` 
WITH (
  KAFKA_TOPIC='adsb-json', 
  PARTITIONS=1, 
  REPLICAS=3, 
  VALUE_FORMAT='JSON'
) AS 
SELECT 
  *,
  date_message_generated + ' ' + time_message_generated AS ts_generated,
  date_message_logged + ' ' + time_message_logged AS ts_logged
FROM ADSB_RAW 
PARTITION BY HEX_IDENT
EMIT CHANGES;
